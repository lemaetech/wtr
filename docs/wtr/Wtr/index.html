<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Wtr (wtr.Wtr)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 244b5317d"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">wtr</a> &#x00BB; Wtr</nav><header class="odoc-preamble"><h1>Module <code><span>Wtr</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#types">Types</a></li><li><a href="#http-method">HTTP Method</a></li><li><a href="#decoder_func">Decoder</a></li><li><a href="#path">Path</a><ul><li><a href="#decoders">Decoders</a></li><li><a href="#ending-path-construction">Ending path construction</a></li></ul></li><li><a href="#query">Query</a></li><li><a href="#uri">URI</a></li><li><a href="#route-and-router">Route and Router</a></li><li><a href="#pp">Pretty Printers</a></li></ul></nav><div class="odoc-content"><h2 id="types"><a href="#types" class="anchor"></a>Types</h2><div class="odoc-spec"><div class="spec type" id="type-router" class="anchored"><a href="#type-router" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a router</span></span></code></div><div class="spec-doc"><p>A <a href="#type-router"><code>router</code></a> consists of one or many HTTP request <a href="#type-route"><code>route</code></a>s. These routes are used to match a given HTTP request target using a radix trie algorithm.</p><p><code>'a</code> represents the value returned after executing the corresponding route handler of a matched route.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-route" class="anchored"><a href="#type-route" class="anchor"></a><code><span><span class="keyword">and</span> <span>'a route</span></span></code></div><div class="spec-doc"><p><a href="#type-route"><code>route</code></a> is a HTTP request route. A route encapsulates a HTTP <a href="#type-method'"><code>method'</code></a>, a <a href="#type-uri"><code>uri</code></a> and a <i>route handler</i>. A <i>route handler</i> is either of the following:</p><ul><li>a value of type <code>'a</code></li><li>a function which returns values of type <code>'a</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec type" id="type-uri" class="anchored"><a href="#type-uri" class="anchor"></a><code><span><span class="keyword">and</span> <span>('a, 'b) uri</span></span></code></div><div class="spec-doc"><p><a href="#type-uri"><code>uri</code></a> represents a HTTP uri value. It encapsulates both <a href="#type-path"><code>path</code></a> and <a href="#type-query"><code>query</code></a> in a route. Path and query are delimited by a <code>?</code> character token.</p><p>Representative examples:</p><ul><li><code>/home/about/</code></li><li><code>/home/contact</code>,</li><li><code>/home/contact?name=a&amp;no=123</code>.</li></ul><p>Consult <a href="#uri">uri combinators</a> for creating values of this type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-path" class="anchored"><a href="#type-path" class="anchor"></a><code><span><span class="keyword">and</span> <span>('a, 'b) path</span></span></code></div><div class="spec-doc"><p><a href="#type-path"><code>path</code></a> is a part of <a href="#type-uri"><code>uri</code></a> where the components are delimited by a <code>/</code> character token.</p><p>Representative examples: <code>/</code>, <code>/home/about</code>, <code>/home/contact/</code>.</p><p>Consult <a href="#path">path combinators</a> for creating values of this type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-query" class="anchored"><a href="#type-query" class="anchor"></a><code><span><span class="keyword">and</span> <span>('a, 'b) query</span></span></code></div><div class="spec-doc"><p><a href="#type-query"><code>query</code></a> is a part of <a href="#type-uri"><code>uri</code></a>. Each query component is generally a pair of <code>name</code> and <code>value</code> - <code>(name,value)</code>. A query component in a uri is delimited by a <code>&amp;</code> character token and the <code>name</code>, <code>value</code> token is delimited by a <code>=</code> character token.</p><p>Given a uri <code>/home/about?a=2&amp;b=3</code>, the query components are <code>(a,2)</code> and <code>(b,3)</code>.</p><p>Consult <a href="#query">query combinators</a> for creating values of this type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-method'" class="anchored"><a href="#type-method'" class="anchor"></a><code><span><span class="keyword">and</span> method'</span><span> = </span><span>[ </span></code><table><tr id="type-method'.GET" class="anchored"><td class="def constructor"><a href="#type-method'.GET" class="anchor"></a><code><span>| </span></code><code><span>`GET</span></code></td></tr><tr id="type-method'.HEAD" class="anchored"><td class="def constructor"><a href="#type-method'.HEAD" class="anchor"></a><code><span>| </span></code><code><span>`HEAD</span></code></td></tr><tr id="type-method'.POST" class="anchored"><td class="def constructor"><a href="#type-method'.POST" class="anchor"></a><code><span>| </span></code><code><span>`POST</span></code></td></tr><tr id="type-method'.PUT" class="anchored"><td class="def constructor"><a href="#type-method'.PUT" class="anchor"></a><code><span>| </span></code><code><span>`PUT</span></code></td></tr><tr id="type-method'.DELETE" class="anchored"><td class="def constructor"><a href="#type-method'.DELETE" class="anchor"></a><code><span>| </span></code><code><span>`DELETE</span></code></td></tr><tr id="type-method'.CONNECT" class="anchored"><td class="def constructor"><a href="#type-method'.CONNECT" class="anchor"></a><code><span>| </span></code><code><span>`CONNECT</span></code></td></tr><tr id="type-method'.OPTIONS" class="anchored"><td class="def constructor"><a href="#type-method'.OPTIONS" class="anchor"></a><code><span>| </span></code><code><span>`OPTIONS</span></code></td></tr><tr id="type-method'.TRACE" class="anchored"><td class="def constructor"><a href="#type-method'.TRACE" class="anchor"></a><code><span>| </span></code><code><span>`TRACE</span></code></td></tr><tr id="type-method'.Method" class="anchored"><td class="def constructor"><a href="#type-method'.Method" class="anchor"></a><code><span>| </span></code><code><span>`Method <span class="keyword">of</span> string</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p><a href="#type-method'"><code>method'</code></a> is a HTTP request method.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-decoder" class="anchored"><a href="#type-decoder" class="anchor"></a><code><span><span class="keyword">and</span> <span>'a decoder</span></span></code></div><div class="spec-doc"><p><a href="#type-decoder"><code>decoder</code></a> is a uri component which can convert a HTTP request uri string value into an OCaml typed value (represented by <code>'a</code>). It can be used in both <a href="#type-path"><code>path</code></a> and <a href="#type-query"><code>query</code></a> values construction.</p></div></div><h2 id="http-method"><a href="#http-method" class="anchor"></a>HTTP Method</h2><div class="odoc-spec"><div class="spec value" id="val-method_equal" class="anchored"><a href="#val-method_equal" class="anchor"></a><code><span><span class="keyword">val</span> method_equal : <span><a href="#type-method'">method'</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-method'">method'</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>method_equal m1 m2</code> is <code>true</code> if <code>m1</code> and <code>m2</code> is the same value. Otherwise it is <code>false</code>.</p><p><i>Note</i> if both <code>m1</code> and <code>m2</code> are <code>`Method m</code> then the string comparison is case insensitive.</p><pre><code>Wtr.method_equal `GET `GET = true;;
Wtr.method_equal `POST `GET = false;;
Wtr.method_equal (`Method &quot;meth&quot;) (`Method &quot;METH&quot;) = true</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-method'" class="anchored"><a href="#val-method'" class="anchor"></a><code><span><span class="keyword">val</span> method' : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-method'">method'</a></span></code></div><div class="spec-doc"><p><code>method' m</code> is <a href="#type-method'"><code>method'</code></a> where string value <code>m</code> is converted to <a href="#type-method'"><code>method'</code></a> as follows:</p><ul><li><code>&quot;GET&quot;</code> to <code>`GET</code></li><li><code>&quot;HEAD&quot;</code> to <code>`HEAD</code></li><li><code>&quot;POST&quot;</code> to <code>`POST</code></li><li><code>&quot;PUT&quot;</code> to <code>`PUT</code></li><li><code>&quot;DELETE&quot;</code> to <code>`DELETE</code></li><li><code>&quot;CONNECT&quot;</code> to <code>`CONNECT</code></li><li><code>&quot;OPTIONS&quot;</code> to <code>`OPTIONS</code></li><li><code>&quot;TRACE&quot;</code> to <code>`TRACE</code></li><li>Any other value <code>m</code> to <code>`Method m</code></li></ul><p><i>Note</i> String comparison is case insensitive.</p><pre><code>Wtr.method' &quot;GET&quot; = `GET;;
Wtr.method' &quot;get&quot; = `GET;;
Wtr.method' &quot;method&quot; = `Method &quot;method&quot;</code></pre></div></div><h2 id="decoder_func"><a href="#decoder_func" class="anchor"></a>Decoder</h2><div class="odoc-spec"><div class="spec value" id="val-decoder" class="anchored"><a href="#val-decoder" class="anchor"></a><code><span><span class="keyword">val</span> decoder : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-decoder">decoder</a></span></span></code></div><div class="spec-doc"><p><code>decoder name decode</code> is <a href="#type-decoder"><code>decoder</code></a> with name <code>name</code> and <code>decode</code> as the string conversion/decoder function.</p><p><code>decode v</code> is <code>Some a</code> if <code>decode</code> can successfully convert <code>v</code> to <code>a</code>. Otherwise it is <code>None</code>.</p><pre><code>module Fruit = struct
  type t = Apple | Orange | Pineapple

  let t : t Wtr.decoder =
    Wtr.decoder &quot;fruit&quot; (function
      | &quot;apple&quot; -&gt; Some Apple
      | &quot;orange&quot; -&gt; Some Orange
      | &quot;pineapple&quot; -&gt; Some Pineapple
      | _ -&gt; None )
end</code></pre></div></div><h2 id="path"><a href="#path" class="anchor"></a>Path</h2><p>Path combinators are used to create <a href="#type-uri"><code>uri</code></a> and <a href="#type-path"><code>path</code></a> values.</p><p>Given the <code>uri</code> below:</p><pre><code>let uri = Wtr.(exact &quot;hello&quot; / int / string /. pend) </code></pre><p>We can match the following HTTP request targets:</p><ul><li><code>/home/2/about</code></li><li><code>/home/3/contact</code></li></ul><h5 id="decoders"><a href="#decoders" class="anchor"></a>Decoders</h5><div class="odoc-spec"><div class="spec value" id="val-int" class="anchored"><a href="#val-int" class="anchor"></a><code><span><span class="keyword">val</span> int : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>int</code> is a path decoder that can decode <code>int</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int32" class="anchored"><a href="#val-int32" class="anchor"></a><code><span><span class="keyword">val</span> int32 : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int32 <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>int32</code> is a path decoder that can decode <code>int32</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int64" class="anchored"><a href="#val-int64" class="anchor"></a><code><span><span class="keyword">val</span> int64 : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int64 <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>int64</code> is a path decoder that can decode <code>int64</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-float" class="anchored"><a href="#val-float" class="anchor"></a><code><span><span class="keyword">val</span> float : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>float <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>float</code> is a path decoder that can decode <code>float</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bool" class="anchored"><a href="#val-bool" class="anchor"></a><code><span><span class="keyword">val</span> bool : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>bool <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>bool</code> is a path decoder that can decode <code>bool</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string" class="anchored"><a href="#val-string" class="anchor"></a><code><span><span class="keyword">val</span> string : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>string</code> is a path decoder that can decode <code>string</code> values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span><span class="keyword">val</span> decode : <span><span><span class="type-var">'c</span> <a href="#type-decoder">decoder</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>decode d p</code> is a path component for custom decoder <code>d</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-exact" class="anchored"><a href="#val-exact" class="anchor"></a><code><span><span class="keyword">val</span> exact : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>exact e p</code> is a path component that matches a uri token <code>e</code> exactly.</p></div></div><h5 id="ending-path-construction"><a href="#ending-path-construction" class="anchor"></a>Ending path construction</h5><p>These combinators affect the last uri component.</p><div class="odoc-spec"><div class="spec value" id="val-pend" class="anchored"><a href="#val-pend" class="anchor"></a><code><span><span class="keyword">val</span> pend : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'a</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>pend</code> ends a path construction.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-splat" class="anchored"><a href="#val-splat" class="anchor"></a><code><span><span class="keyword">val</span> splat : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'a</span>)</span> <a href="#type-path">path</a></span></span></code></div><div class="spec-doc"><p><code>splat</code> is a path component that matches the remaining uri components.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-slash" class="anchored"><a href="#val-slash" class="anchor"></a><code><span><span class="keyword">val</span> slash : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'a</span>)</span> <a href="#type-path">path</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-(/)" class="anchored"><a href="#val-(/)" class="anchor"></a><code><span><span class="keyword">val</span> (/) : <span><span>(<span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-(/.)" class="anchored"><a href="#val-(/.)" class="anchor"></a><code><span><span class="keyword">val</span> (/.) : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span> <a href="#type-path">path</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span> <a href="#type-uri">uri</a></span></span></code></div></div><h2 id="query"><a href="#query" class="anchor"></a>Query</h2><div class="odoc-spec"><div class="spec value" id="val-qint" class="anchored"><a href="#val-qint" class="anchor"></a><code><span><span class="keyword">val</span> qint : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qint32" class="anchored"><a href="#val-qint32" class="anchor"></a><code><span><span class="keyword">val</span> qint32 : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int32 <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qint64" class="anchored"><a href="#val-qint64" class="anchor"></a><code><span><span class="keyword">val</span> qint64 : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int64 <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qfloat" class="anchored"><a href="#val-qfloat" class="anchor"></a><code><span><span class="keyword">val</span> qfloat : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>float <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qbool" class="anchored"><a href="#val-qbool" class="anchor"></a><code><span><span class="keyword">val</span> qbool : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>bool <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qstring" class="anchored"><a href="#val-qstring" class="anchor"></a><code><span><span class="keyword">val</span> qstring : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qdecode" class="anchored"><a href="#val-qdecode" class="anchor"></a><code><span><span class="keyword">val</span> qdecode : <span><span>(string * <span><span class="type-var">'c</span> <a href="#type-decoder">decoder</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-qexact" class="anchored"><a href="#val-qexact" class="anchor"></a><code><span><span class="keyword">val</span> qexact : <span><span>(string * string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-(/&amp;)" class="anchored"><a href="#val-(/&amp;)" class="anchor"></a><code><span><span class="keyword">val</span> (/&amp;) : <span><span>(<span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span></span></code></div></div><h2 id="uri"><a href="#uri" class="anchor"></a>URI</h2><div class="odoc-spec"><div class="spec value" id="val-(/?)" class="anchored"><a href="#val-(/?)" class="anchor"></a><code><span><span class="keyword">val</span> (/?) : <span><span>(<span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-path">path</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span></span></code></div><div class="spec-doc"><p><code> pc /? qc</code> is a closure which encapsulates path closure <code>pc</code> and query closure <code>qc</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-(/?.)" class="anchored"><a href="#val-(/?.)" class="anchor"></a><code><span><span class="keyword">val</span> (/?.) : <span><span>(<span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'b</span>)</span> <a href="#type-query">query</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'c</span>, <span class="type-var">'d</span>)</span> <a href="#type-path">path</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'c</span>, <span class="type-var">'d</span>)</span> <a href="#type-uri">uri</a></span></span></code></div><div class="spec-doc"><p><code> pqc /?. ()</code> is a <a href="#type-uri"><code>uri</code></a> where <code>pqc</code> is a closure encapulating both <a href="#type-path"><code>path</code></a> and <a href="#type-query"><code>query</code></a> - see <a href="#val-(/?)"><code>(/?)</code></a>.</p><pre><code>let uri1 =
  exact &quot;hello&quot; / bool /? qint &quot;hello&quot; /&amp; qstring &quot;hh&quot; /&amp; qbool &quot;b&quot; /?. ()</code></pre></div></div><h2 id="route-and-router"><a href="#route-and-router" class="anchor"></a>Route and Router</h2><div class="odoc-spec"><div class="spec value" id="val-route" class="anchored"><a href="#val-route" class="anchor"></a><code><span><span class="keyword">val</span> route : <span>?method':<a href="#type-method'">method'</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-uri">uri</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-route">route</a></span></span></code></div><div class="spec-doc"><p><code>route ~method' uri handler</code> is a <a href="#type-route"><code>route</code></a>. The default value for <code>?method</code> is <code>`GET</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-routes" class="anchored"><a href="#val-routes" class="anchor"></a><code><span><span class="keyword">val</span> routes : <span><span><a href="#type-method'">method'</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-uri">uri</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-route">route</a></span> list</span></span></code></div><div class="spec-doc"><p><code>routes methods uri handler</code> is a list of routes in which all have the same <code>uri</code> and route <code>handler</code> value but each have one <code>method'</code> from <code>methods</code>. This is equivalent to calling <a href="#val-route"><code>route</code></a> like so:</p><pre><code>List.map (fun m -&gt; route ~method:m uri handler) [meth1; meth2; meth3] </code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-router" class="anchored"><a href="#val-router" class="anchor"></a><code><span><span class="keyword">val</span> router : <span><span><span><span><span class="type-var">'a</span> <a href="#type-route">route</a></span> list</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-router">router</a></span></span></code></div><div class="spec-doc"><p><code>router routes</code> is a <a href="#type-router"><code>router</code></a> made up of given <code>routes</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-match'" class="anchored"><a href="#val-match'" class="anchor"></a><code><span><span class="keyword">val</span> match' : <span><a href="#type-method'">method'</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-router">router</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>match' method' request_target router</code> is <code>Some a</code> if <code>method'</code> and <code>request_target</code> together matches one of the routes defined in <code>router</code>. Otherwise it is None.</p></div></div><h2 id="pp"><a href="#pp" class="anchor"></a>Pretty Printers</h2><div class="odoc-spec"><div class="spec value" id="val-pp_method" class="anchored"><a href="#val-pp_method" class="anchor"></a><code><span><span class="keyword">val</span> pp_method : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-method'">method'</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_route" class="anchored"><a href="#val-pp_route" class="anchor"></a><code><span><span class="keyword">val</span> pp_route : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-route">route</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_uri" class="anchored"><a href="#val-pp_uri" class="anchor"></a><code><span><span class="keyword">val</span> pp_uri : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-uri">uri</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-router">router</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>